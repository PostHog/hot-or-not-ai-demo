{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///Users/landondepasquale/hot-or-not-leads/lib/auth.ts"],"sourcesContent":["import { SignJWT, jwtVerify } from 'jose';\nimport { cookies } from 'next/headers';\nimport type { Session, User } from './types';\n\nconst secretKey = new TextEncoder().encode(\n  process.env.AUTH_SECRET || 'hot-or-not-leads-secret-key-2002'\n);\n\n// Mock user database - in production this would be a real database\nconst users: User[] = [\n  {\n    id: '1',\n    email: 'demo@hotornot.com',\n    name: 'Demo User',\n    passwordHash: '$2a$10$m9SF5L1FFt/5kBW0DjDh/uDho4SJsjbJ0j5hUaB2minPRqf9M3YOC', // password: demo123\n  },\n];\n\n// Anonymous session for non-logged-in users\nexport function getAnonymousSession(): Session {\n  return {\n    userId: 'anonymous',\n    email: '',\n    name: 'Guest',\n  };\n}\n\nexport async function getSessionOrAnonymous(): Promise<Session> {\n  const session = await getSession();\n  return session || getAnonymousSession();\n}\n\nexport async function hashPassword(password: string): Promise<string> {\n  const bcrypt = await import('bcryptjs');\n  return bcrypt.hash(password, 10);\n}\n\nexport async function verifyPassword(password: string, hash: string): Promise<boolean> {\n  const bcrypt = await import('bcryptjs');\n  return bcrypt.compare(password, hash);\n}\n\nexport async function createSession(user: Omit<User, 'passwordHash'>): Promise<string> {\n  const session: Session = {\n    userId: user.id,\n    email: user.email,\n    name: user.name,\n  };\n\n  const token = await new SignJWT(session as unknown as Record<string, unknown>)\n    .setProtectedHeader({ alg: 'HS256' })\n    .setExpirationTime('7d')\n    .sign(secretKey);\n\n  return token;\n}\n\nexport async function getSession(): Promise<Session | null> {\n  const cookieStore = await cookies();\n  const token = cookieStore.get('session')?.value;\n\n  if (!token) return null;\n\n  try {\n    const { payload } = await jwtVerify(token, secretKey);\n    return payload as unknown as Session;\n  } catch {\n    return null;\n  }\n}\n\nexport async function login(email: string, password: string): Promise<{ success: boolean; error?: string }> {\n  const user = users.find((u) => u.email === email);\n\n  if (!user) {\n    return { success: false, error: 'Invalid email or password' };\n  }\n\n  const valid = await verifyPassword(password, user.passwordHash);\n  if (!valid) {\n    return { success: false, error: 'Invalid email or password' };\n  }\n\n  const token = await createSession({ id: user.id, email: user.email, name: user.name });\n  const cookieStore = await cookies();\n  cookieStore.set('session', token, {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === 'production',\n    sameSite: 'lax',\n    maxAge: 60 * 60 * 24 * 7, // 7 days\n  });\n\n  return { success: true };\n}\n\nexport async function signup(email: string, password: string, name: string): Promise<{ success: boolean; error?: string }> {\n  const existing = users.find((u) => u.email === email);\n  if (existing) {\n    return { success: false, error: 'Email already registered' };\n  }\n\n  const passwordHash = await hashPassword(password);\n  const newUser: User = {\n    id: String(users.length + 1),\n    email,\n    name,\n    passwordHash,\n  };\n  users.push(newUser);\n\n  const token = await createSession({ id: newUser.id, email: newUser.email, name: newUser.name });\n  const cookieStore = await cookies();\n  cookieStore.set('session', token, {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === 'production',\n    sameSite: 'lax',\n    maxAge: 60 * 60 * 24 * 7,\n  });\n\n  return { success: true };\n}\n\nexport async function logout(): Promise<void> {\n  const cookieStore = await cookies();\n  cookieStore.delete('session');\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AACA;;;AAGA,MAAM,YAAY,IAAI,cAAc,MAAM,CACxC,QAAQ,GAAG,CAAC,WAAW,IAAI;AAG7B,mEAAmE;AACnE,MAAM,QAAgB;IACpB;QACE,IAAI;QACJ,OAAO;QACP,MAAM;QACN,cAAc;IAChB;CACD;AAGM,SAAS;IACd,OAAO;QACL,QAAQ;QACR,OAAO;QACP,MAAM;IACR;AACF;AAEO,eAAe;IACpB,MAAM,UAAU,MAAM;IACtB,OAAO,WAAW;AACpB;AAEO,eAAe,aAAa,QAAgB;IACjD,MAAM,SAAS;IACf,OAAO,OAAO,IAAI,CAAC,UAAU;AAC/B;AAEO,eAAe,eAAe,QAAgB,EAAE,IAAY;IACjE,MAAM,SAAS;IACf,OAAO,OAAO,OAAO,CAAC,UAAU;AAClC;AAEO,eAAe,cAAc,IAAgC;IAClE,MAAM,UAAmB;QACvB,QAAQ,KAAK,EAAE;QACf,OAAO,KAAK,KAAK;QACjB,MAAM,KAAK,IAAI;IACjB;IAEA,MAAM,QAAQ,MAAM,IAAI,uKAAO,CAAC,SAC7B,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,iBAAiB,CAAC,MAClB,IAAI,CAAC;IAER,OAAO;AACT;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,MAAM,QAAQ,YAAY,GAAG,CAAC,YAAY;IAE1C,IAAI,CAAC,OAAO,OAAO;IAEnB,IAAI;QACF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,2KAAS,EAAC,OAAO;QAC3C,OAAO;IACT,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,eAAe,MAAM,KAAa,EAAE,QAAgB;IACzD,MAAM,OAAO,MAAM,IAAI,CAAC,CAAC,IAAM,EAAE,KAAK,KAAK;IAE3C,IAAI,CAAC,MAAM;QACT,OAAO;YAAE,SAAS;YAAO,OAAO;QAA4B;IAC9D;IAEA,MAAM,QAAQ,MAAM,eAAe,UAAU,KAAK,YAAY;IAC9D,IAAI,CAAC,OAAO;QACV,OAAO;YAAE,SAAS;YAAO,OAAO;QAA4B;IAC9D;IAEA,MAAM,QAAQ,MAAM,cAAc;QAAE,IAAI,KAAK,EAAE;QAAE,OAAO,KAAK,KAAK;QAAE,MAAM,KAAK,IAAI;IAAC;IACpF,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,YAAY,GAAG,CAAC,WAAW,OAAO;QAChC,UAAU;QACV,QAAQ,oDAAyB;QACjC,UAAU;QACV,QAAQ,KAAK,KAAK,KAAK;IACzB;IAEA,OAAO;QAAE,SAAS;IAAK;AACzB;AAEO,eAAe,OAAO,KAAa,EAAE,QAAgB,EAAE,IAAY;IACxE,MAAM,WAAW,MAAM,IAAI,CAAC,CAAC,IAAM,EAAE,KAAK,KAAK;IAC/C,IAAI,UAAU;QACZ,OAAO;YAAE,SAAS;YAAO,OAAO;QAA2B;IAC7D;IAEA,MAAM,eAAe,MAAM,aAAa;IACxC,MAAM,UAAgB;QACpB,IAAI,OAAO,MAAM,MAAM,GAAG;QAC1B;QACA;QACA;IACF;IACA,MAAM,IAAI,CAAC;IAEX,MAAM,QAAQ,MAAM,cAAc;QAAE,IAAI,QAAQ,EAAE;QAAE,OAAO,QAAQ,KAAK;QAAE,MAAM,QAAQ,IAAI;IAAC;IAC7F,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,YAAY,GAAG,CAAC,WAAW,OAAO;QAChC,UAAU;QACV,QAAQ,oDAAyB;QACjC,UAAU;QACV,QAAQ,KAAK,KAAK,KAAK;IACzB;IAEA,OAAO;QAAE,SAAS;IAAK;AACzB;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,YAAY,MAAM,CAAC;AACrB","debugId":null}},
    {"offset": {"line": 232, "column": 0}, "map": {"version":3,"sources":["file:///Users/landondepasquale/hot-or-not-leads/lib/leads.ts"],"sourcesContent":["import { readFileSync, writeFileSync } from 'fs';\nimport { join } from 'path';\nimport type { Lead, Rating, LeadWithRating } from './types';\n\nconst leadsPath = join(process.cwd(), 'lib/data/leads.json');\nconst ratingsPath = join(process.cwd(), 'lib/data/ratings.json');\n\nexport function getLeads(): Lead[] {\n  const data = readFileSync(leadsPath, 'utf-8');\n  return JSON.parse(data).leads;\n}\n\nexport function getLead(id: string): Lead | undefined {\n  const leads = getLeads();\n  return leads.find((lead) => lead.id === id);\n}\n\nexport function getRatings(): Record<string, Rating[]> {\n  try {\n    const data = readFileSync(ratingsPath, 'utf-8');\n    return JSON.parse(data).ratings || {};\n  } catch {\n    return {};\n  }\n}\n\nexport function saveRatings(ratings: Record<string, Rating[]>): void {\n  writeFileSync(ratingsPath, JSON.stringify({ ratings }, null, 2));\n}\n\nexport function addRating(leadId: string, userId: string, score: number): void {\n  const ratings = getRatings();\n\n  if (!ratings[leadId]) {\n    ratings[leadId] = [];\n  }\n\n  // Check if user already rated this lead\n  const existingIndex = ratings[leadId].findIndex((r) => r.userId === userId);\n\n  const newRating: Rating = {\n    userId,\n    leadId,\n    score,\n    ratedAt: new Date().toISOString(),\n  };\n\n  if (existingIndex >= 0) {\n    // Update existing rating\n    ratings[leadId][existingIndex] = newRating;\n  } else {\n    // Add new rating\n    ratings[leadId].push(newRating);\n  }\n\n  saveRatings(ratings);\n}\n\nexport function getLeadRatings(leadId: string): Rating[] {\n  const ratings = getRatings();\n  return ratings[leadId] || [];\n}\n\nexport function calculateAverageRating(leadId: string): { average: number | null; total: number } {\n  const ratings = getLeadRatings(leadId);\n\n  if (ratings.length === 0) {\n    return { average: null, total: 0 };\n  }\n\n  const sum = ratings.reduce((acc, r) => acc + r.score, 0);\n  return {\n    average: Math.round((sum / ratings.length) * 10) / 10,\n    total: ratings.length,\n  };\n}\n\nexport function getLeadsWithRatings(): LeadWithRating[] {\n  const leads = getLeads();\n\n  return leads.map((lead) => {\n    const { average, total } = calculateAverageRating(lead.id);\n    return {\n      ...lead,\n      averageRating: average,\n      totalRatings: total,\n    };\n  });\n}\n\nexport function getLeaderboard(): LeadWithRating[] {\n  const leadsWithRatings = getLeadsWithRatings();\n\n  // Sort by average rating (descending), then by total ratings (descending)\n  return leadsWithRatings\n    .filter((lead) => lead.averageRating !== null)\n    .sort((a, b) => {\n      if (b.averageRating !== a.averageRating) {\n        return (b.averageRating || 0) - (a.averageRating || 0);\n      }\n      return b.totalRatings - a.totalRatings;\n    });\n}\n\nexport function getRandomUnratedLead(userId: string, skipIds: string[] = []): Lead | null {\n  const leads = getLeads();\n  const ratings = getRatings();\n\n  // Get leads not rated by this user and not in skip list\n  const unratedLeads = leads.filter((lead) => {\n    const leadRatings = ratings[lead.id] || [];\n    const hasUserRated = leadRatings.some((r) => r.userId === userId);\n    const isSkipped = skipIds.includes(lead.id);\n    return !hasUserRated && !isSkipped;\n  });\n\n  if (unratedLeads.length === 0) {\n    // If all leads are rated or skipped, return a random lead not in skip list\n    const availableLeads = leads.filter((lead) => !skipIds.includes(lead.id));\n    if (availableLeads.length === 0) {\n      // If all leads are skipped, reset and return any random lead\n      return leads[Math.floor(Math.random() * leads.length)] || null;\n    }\n    return availableLeads[Math.floor(Math.random() * availableLeads.length)] || null;\n  }\n\n  // Return a random unrated lead\n  return unratedLeads[Math.floor(Math.random() * unratedLeads.length)] || null;\n}\n\nexport function hasUserRatedLead(userId: string, leadId: string): boolean {\n  const ratings = getRatings();\n  const leadRatings = ratings[leadId] || [];\n  return leadRatings.some((r) => r.userId === userId);\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 375, "column": 0}, "map": {"version":3,"sources":["file:///Users/landondepasquale/hot-or-not-leads/app/api/leads/random/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { getSessionOrAnonymous } from '@/lib/auth';\nimport { getRandomUnratedLead, calculateAverageRating } from '@/lib/leads';\n\nexport async function POST(request: Request) {\n  try {\n    const session = await getSessionOrAnonymous();\n    const { skipIds = [] } = await request.json();\n\n    const lead = getRandomUnratedLead(session.userId, skipIds);\n\n    if (!lead) {\n      return NextResponse.json({ lead: null, message: 'No more leads to rate!' });\n    }\n\n    const { average, total } = calculateAverageRating(lead.id);\n\n    return NextResponse.json({\n      lead: {\n        ...lead,\n        averageRating: average,\n        totalRatings: total,\n      },\n    });\n  } catch (error) {\n    console.error('Error in /api/leads/random:', error);\n    return NextResponse.json({ error: 'Failed to fetch lead' }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,MAAM,UAAU,MAAM,IAAA,sIAAqB;QAC3C,MAAM,EAAE,UAAU,EAAE,EAAE,GAAG,MAAM,QAAQ,IAAI;QAE3C,MAAM,OAAO,IAAA,sIAAoB,EAAC,QAAQ,MAAM,EAAE;QAElD,IAAI,CAAC,MAAM;YACT,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,MAAM;gBAAM,SAAS;YAAyB;QAC3E;QAEA,MAAM,EAAE,OAAO,EAAE,KAAK,EAAE,GAAG,IAAA,wIAAsB,EAAC,KAAK,EAAE;QAEzD,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,MAAM;gBACJ,GAAG,IAAI;gBACP,eAAe;gBACf,cAAc;YAChB;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAuB,GAAG;YAAE,QAAQ;QAAI;IAC5E;AACF","debugId":null}}]
}